<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}VideoGen{% endblock %} — Генератор видео</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1a2234',
                            950: '#0a0f1a'
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-900 text-slate-100 min-h-screen">
    {% if show_navbar %}
    <nav class="navbar-blur fixed top-0 left-0 right-0 z-50 border-b border-slate-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="/" class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-violet-500 to-cyan-500 rounded-xl flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <span class="text-xl font-bold bg-gradient-to-r from-violet-400 to-cyan-400 bg-clip-text text-transparent">VideoGen</span>
                </a>

                {% if user_id %}
                <div class="flex items-center gap-6">
                    <a href="/app" class="text-slate-300 hover:text-white transition-colors {% if active_page == 'dashboard' %}text-white{% endif %}">Панель</a>
                    <a href="/app/youtube" class="text-slate-300 hover:text-white transition-colors {% if active_page == 'youtube' %}text-white{% endif %}">YouTube → Shorts</a>
                    <a href="/app/create" class="text-slate-300 hover:text-white transition-colors {% if active_page == 'create' %}text-white{% endif %}">Создать</a>
                    <a href="/app/jobs" class="text-slate-300 hover:text-white transition-colors {% if active_page == 'jobs' %}text-white{% endif %}">Мои видео</a>
                    <button onclick="openEditor()" class="text-slate-300 hover:text-white transition-colors {% if active_page == 'editor' %}text-white{% endif %}">Редактор</button>
                    <div class="flex items-center gap-2 px-4 py-2 bg-slate-800 rounded-full">
                        <svg class="w-5 h-5 text-violet-400" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.736 6.979C9.208 6.193 9.696 6 10 6c.304 0 .792.193 1.264.979a1 1 0 001.715-1.029C12.279 4.784 11.232 4 10 4s-2.279.784-2.979 1.95c-.285.475-.507 1-.67 1.55H6a1 1 0 000 2h.013a9.358 9.358 0 000 1H6a1 1 0 100 2h.351c.163.55.385 1.075.67 1.55C7.721 15.216 8.768 16 10 16s2.279-.784 2.979-1.95a1 1 0 10-1.715-1.029c-.472.786-.96.979-1.264.979-.304 0-.792-.193-1.264-.979a5.38 5.38 0 01-.491-.921H10a1 1 0 100-2H8.017a7.36 7.36 0 010-1H10a1 1 0 100-2H8.245c.128-.346.289-.667.491-.921z"/>
                        </svg>
                        <span class="font-semibold text-white">{{ credits }}</span>
                    </div>
                </div>
                {% else %}
                <a href="/app" class="px-6 py-2 bg-gradient-to-r from-violet-600 to-violet-500 hover:from-violet-500 hover:to-violet-400 text-white font-medium rounded-full transition-all btn-glow">
                    Войти
                </a>
                {% endif %}
            </div>
        </div>
    </nav>
    <div class="h-16"></div>
    {% endif %}

    <main>
        {% block content %}{% endblock %}
    </main>

    {% if show_footer %}
    <footer class="border-t border-slate-800 mt-20">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-violet-500 to-cyan-500 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <span class="font-semibold text-slate-400">VideoGen</span>
                </div>
                <p class="text-slate-500 text-sm">Генератор коротких видео с озвучкой</p>
            </div>
        </div>
    </footer>
    {% endif %}

    <script>
    async function openEditor() {
        try {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'Загрузка...';
            btn.disabled = true;

            const response = await fetch('/api/clips/demo/create-batch', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (!response.ok) {
                throw new Error('Ошибка создания проекта');
            }

            const data = await response.json();
            if (data.editor_url) {
                window.location.href = data.editor_url;
            } else {
                throw new Error('Нет URL редактора');
            }
        } catch (error) {
            console.error('Ошибка:', error);
            if (event.target) {
                event.target.textContent = 'Редактор';
                event.target.disabled = false;
            }
        }
    }
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>
